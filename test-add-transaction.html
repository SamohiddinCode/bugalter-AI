<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тест добавления транзакций</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .btn {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            background: #007bff;
            color: white;
        }
        .btn:hover {
            background: #0056b3;
        }
        .transaction-item {
            padding: 10px;
            margin: 5px 0;
            border: 1px solid #eee;
            border-radius: 4px;
            background: #f9f9f9;
        }
        .income { color: green; }
        .expense { color: red; }
    </style>
</head>
<body>
    <h1>Тест добавления транзакций</h1>
    
    <div class="test-section">
        <h2>Добавить транзакцию</h2>
        <form id="transaction-form">
            <div>
                <label>Тип:</label>
                <select id="type" required>
                    <option value="income">Доход</option>
                    <option value="expense">Расход</option>
                </select>
            </div>
            <div>
                <label>Сумма:</label>
                <input type="number" id="amount" required>
            </div>
            <div>
                <label>Категория:</label>
                <input type="text" id="category" required>
            </div>
            <div>
                <label>Описание:</label>
                <input type="text" id="description" required>
            </div>
            <div>
                <label>Дата:</label>
                <input type="date" id="date" required>
            </div>
            <button type="submit" class="btn">Добавить транзакцию</button>
        </form>
    </div>
    
    <div class="test-section">
        <h2>Текущие транзакции</h2>
        <div id="transactions-display"></div>
    </div>
    
    <div class="test-section">
        <h2>localStorage данные</h2>
        <pre id="localstorage-data"></pre>
    </div>
    
    <div class="test-section">
        <h2>Проверить в основном приложении</h2>
        <a href="/index.html#transactions" class="btn">Открыть раздел транзакций</a>
    </div>

    <script>
        // Устанавливаем сегодняшнюю дату по умолчанию
        document.getElementById('date').value = new Date().toISOString().split('T')[0];
        
        document.getElementById('transaction-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const type = document.getElementById('type').value;
            const amount = parseFloat(document.getElementById('amount').value);
            const category = document.getElementById('category').value;
            const description = document.getElementById('description').value;
            const date = document.getElementById('date').value;
            
            const transaction = {
                id: Date.now(),
                amount: type === 'expense' ? -Math.abs(amount) : Math.abs(amount),
                type: type,
                category: category,
                description: description,
                date: date,
                createdAt: new Date().toISOString()
            };
            
            // Сохраняем в localStorage
            const transactions = JSON.parse(localStorage.getItem('transactions') || '[]');
            transactions.push(transaction);
            localStorage.setItem('transactions', JSON.stringify(transactions));
            
            alert('Транзакция добавлена!');
            
            // Очищаем форму
            document.getElementById('transaction-form').reset();
            document.getElementById('date').value = new Date().toISOString().split('T')[0];
            
            // Обновляем отображение
            showTransactions();
            showLocalStorageData();
        });
        
        function showTransactions() {
            const transactions = JSON.parse(localStorage.getItem('transactions') || '[]');
            const display = document.getElementById('transactions-display');
            
            if (transactions.length === 0) {
                display.innerHTML = '<p>Нет транзакций</p>';
                return;
            }
            
            display.innerHTML = transactions.map(t => `
                <div class="transaction-item">
                    <strong>${t.description}</strong><br>
                    Категория: ${t.category}<br>
                    Сумма: <span class="${t.type}">${t.type === 'income' ? '+' : '-'}${Math.abs(t.amount)}</span><br>
                    Дата: ${t.date}<br>
                    ID: ${t.id}
                </div>
            `).join('');
        }
        
        function showLocalStorageData() {
            const data = document.getElementById('localstorage-data');
            const transactions = localStorage.getItem('transactions');
            data.textContent = transactions || 'Нет данных';
        }
        
        // Инициализация
        showTransactions();
        showLocalStorageData();
    </script>
</body>
</html> 