<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û—Ç–ª–∞–¥–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        .debug-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #f9f9f9;
        }
        .btn {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            background: #007bff;
            color: white;
        }
        .btn:hover {
            background: #0056b3;
        }
        .btn-success { background: #28a745; }
        .btn-danger { background: #dc3545; }
        .transaction-item {
            padding: 10px;
            margin: 5px 0;
            border: 1px solid #eee;
            border-radius: 4px;
            background: white;
        }
        .income { color: green; }
        .expense { color: red; }
        .debug-info {
            background: #e9ecef;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .error { color: red; }
        .success { color: green; }
    </style>
</head>
<body>
    <h1>üîß –û—Ç–ª–∞–¥–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</h1>
    
    <div class="debug-section">
        <h2>üìä –°–æ—Å—Ç–æ—è–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</h2>
        <div id="data-status"></div>
        <button class="btn" onclick="checkDataStatus()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ</button>
        <button class="btn btn-danger" onclick="clearAllData()">–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ</button>
    </div>
    
    <div class="debug-section">
        <h2>‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</h2>
        <button class="btn btn-success" onclick="addTestTransactions()">–î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</button>
        <button class="btn" onclick="addSingleTransaction()">–î–æ–±–∞–≤–∏—Ç—å –æ–¥–Ω—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é</button>
    </div>
    
    <div class="debug-section">
        <h2>üìã –¢–µ–∫—É—â–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</h2>
        <div id="transactions-display"></div>
    </div>
    
    <div class="debug-section">
        <h2>üîç localStorage –¥–∞–Ω–Ω—ã–µ</h2>
        <pre id="localstorage-data"></pre>
    </div>
    
    <div class="debug-section">
        <h2>üêõ –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
        <div id="debug-log"></div>
    </div>

    <script>
        function log(message, type = 'info') {
            const debugLog = document.getElementById('debug-log');
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'error' ? 'red' : type === 'success' ? 'green' : 'black';
            debugLog.innerHTML += `<div style="color: ${color}">[${timestamp}] ${message}</div>`;
            debugLog.scrollTop = debugLog.scrollHeight;
        }
        
        function checkDataStatus() {
            const transactions = JSON.parse(localStorage.getItem('transactions') || '[]');
            const status = document.getElementById('data-status');
            
            status.innerHTML = `
                <div class="debug-info">
                    <strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π:</strong> ${transactions.length}<br>
                    <strong>localStorage –∫–ª—é—á–∏:</strong> ${Object.keys(localStorage).join(', ')}<br>
                    <strong>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:</strong> ${new Date().toLocaleString()}
                </div>
            `;
            
            log(`–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è: –Ω–∞–π–¥–µ–Ω–æ ${transactions.length} —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π`);
        }
        
        function clearAllData() {
            localStorage.removeItem('transactions');
            localStorage.removeItem('budgets');
            localStorage.removeItem('budget-categories');
            localStorage.removeItem('financial-goals');
            localStorage.removeItem('ai-chat-history');
            
            log('–í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã', 'success');
            showTransactions();
            showLocalStorageData();
            checkDataStatus();
        }
        
        function addTestTransactions() {
            const transactions = [
                {
                    id: Date.now(),
                    amount: 50000,
                    type: 'income',
                    category: 'salary',
                    description: '–ó–∞—Ä–ø–ª–∞—Ç–∞ –∑–∞ –∞–≤–≥—É—Å—Ç',
                    date: new Date().toISOString().split('T')[0],
                    createdAt: new Date().toISOString()
                },
                {
                    id: Date.now() + 1,
                    amount: -15000,
                    type: 'expense',
                    category: 'food',
                    description: '–ü—Ä–æ–¥—É–∫—Ç—ã –Ω–∞ –Ω–µ–¥–µ–ª—é',
                    date: new Date().toISOString().split('T')[0],
                    createdAt: new Date().toISOString()
                },
                {
                    id: Date.now() + 2,
                    amount: -5000,
                    type: 'expense',
                    category: 'transport',
                    description: '–¢–∞–∫—Å–∏',
                    date: new Date().toISOString().split('T')[0],
                    createdAt: new Date().toISOString()
                },
                {
                    id: Date.now() + 3,
                    amount: 10000,
                    type: 'income',
                    category: 'freelance',
                    description: '–§—Ä–∏–ª–∞–Ω—Å –ø—Ä–æ–µ–∫—Ç',
                    date: new Date().toISOString().split('T')[0],
                    createdAt: new Date().toISOString()
                }
            ];
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
            localStorage.setItem('transactions', JSON.stringify(transactions));
            
            log(`–î–æ–±–∞–≤–ª–µ–Ω–æ ${transactions.length} —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π`, 'success');
            showTransactions();
            showLocalStorageData();
            checkDataStatus();
        }
        
        function addSingleTransaction() {
            const transactions = JSON.parse(localStorage.getItem('transactions') || '[]');
            
            const newTransaction = {
                id: Date.now(),
                amount: Math.random() > 0.5 ? 10000 : -5000,
                type: Math.random() > 0.5 ? 'income' : 'expense',
                category: Math.random() > 0.5 ? 'salary' : 'food',
                description: `–¢–µ—Å—Ç–æ–≤–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è ${new Date().toLocaleTimeString()}`,
                date: new Date().toISOString().split('T')[0],
                createdAt: new Date().toISOString()
            };
            
            transactions.push(newTransaction);
            localStorage.setItem('transactions', JSON.stringify(transactions));
            
            log(`–î–æ–±–∞–≤–ª–µ–Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è: ${newTransaction.description}`, 'success');
            showTransactions();
            showLocalStorageData();
            checkDataStatus();
        }
        
        function showTransactions() {
            const transactions = JSON.parse(localStorage.getItem('transactions') || '[]');
            const display = document.getElementById('transactions-display');
            
            if (transactions.length === 0) {
                display.innerHTML = '<p>–ù–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</p>';
                return;
            }
            
            display.innerHTML = transactions.map(t => `
                <div class="transaction-item">
                    <strong>${t.description}</strong><br>
                    –ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${t.category}<br>
                    –°—É–º–º–∞: <span class="${t.type}">${t.type === 'income' ? '+' : '-'}${Math.abs(t.amount)}</span><br>
                    –î–∞—Ç–∞: ${t.date}<br>
                    ID: ${t.id}
                </div>
            `).join('');
        }
        
        function showLocalStorageData() {
            const data = document.getElementById('localstorage-data');
            const transactions = localStorage.getItem('transactions');
            data.textContent = transactions || '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö';
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        log('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—Ç–ª–∞–¥–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
        checkDataStatus();
        showTransactions();
        showLocalStorageData();
    </script>
</body>
</html> 